# TODO-APP

## Описание проекта

Этот проект представляет собой Go веб-сервер, который реализует функциональность простейшего планировщика задач. Приложение позволяет создавать, редактировать, удалять и отмечать задачи как выполненные. В проекте используется REST API, все данные хранятся в базе данных SQLite.

## Структура проекта

```
TODO-APP/
├── auth/
│   └── auth.go              # Модуль для аутентификации и обработки JWT токенов
├── db/
│   └── db.go                # Модуль для работы с базой данных
├── handlers/
│   ├── nextdate_handler.go  # Обработчик для получения следующей даты
│   ├── task_handler.go      # Обработчик для работы с задачами
│   └── tasks_handler.go     # Обработчик для получения списка задач
├── router/
│   └── router.go            # Настройка маршрутов и middleware
├── tests/                   # Тесты
│   └── settings.go          # Настройки для тестов
├── utils/
│   └── utils.go             # Функции с логикой работы с датами
├── web/                     # Фронтенд
├── .env                     # Файл с переменными окружения
├── .gitignore               # Файл для исключения из git
├── Dockerfile               # Файл для сборки Docker образа
├── go.mod                   # Модуль Go
├── go.sum                   # Хеши для зависимостей Go
├── main.go                  # Точка входа в приложение
├── README.md                # Документация
└── scheduler.db             # База данных SQLite (в случае отсутствия создается при первом запуске приложения)
```

## Выполненные задания со звёздочкой
Все задания, которые были указаны "со звездочкой", реализованы в данном проекте.

## Инструкция по запуску кода локально

### Предварительные условия

- Установлен Go (версии 1.22.1 и выше)
- Установлен SQLite или фреймворк, поддерживающий работу БД данного типа в вашей ОС

### Файл .env

Создайте файл `.env` в корне проекта со следующим содержимым:

```
TODO_DBFILE=scheduler.db
TODO_PASSWORD=
PORT=7540
```

### Объяснение переменных окружения

- `TODO_DBFILE`: Это переменная окружения, которая может содержать как только имя файла, так и полный путь к файлу базы данных. Всё зависит от того, где вы хотите, чтобы файл базы данных был создан и использован. Если вы указываете только имя файла, например, `scheduler.db`, то база данных будет создана в текущей рабочей директории приложения. Если вы хотите указать конкретный путь, например, `/app/data/scheduler.db`, то база данных будет создана и использоваться в указанной директории.
  
- `TODO_PASSWORD`: В этой переменной окружения указывается пароль, который будет использован при авторизации после запуска приложения по его адресу http://localhost:7540/login.html.

- `PORT`: Это переменная окружения, которая используется для определения порта, на котором будет запущен ваш веб-сервер. Если переменная не задана, сервер будет использовать значение по умолчанию (7540). Убедитесь, что порт не занят другим приложением перед запуском сервера.

### Запуск приложения

1. Установите зависимости командой:

```sh
go mod download
```

2. Запустите приложение:

```sh
go run main.go
```

Приложение будет доступно по адресу http://localhost:7540

## Инструкция по запуску тестов

### Получение токена авторизации

Чтобы выполнить тесты, вам нужно получить токен авторизации. Для этого:
1. Запустите приложение локально.
2. Перейдите в браузере по адресу http://localhost:7540/login.html.
3. Введите пароль и нажмите кнопку "Войти".
4. Используйте инструменты разработчика вашего браузера (обычно доступны по нажатию F12) и перейдите на вкладку "Application" (Приложение).
5. В разделе "Cookies" найдите куку с именем `token`.
6. Скопируйте значение этой куки.

### Настройка тестов

В файле `tests/settings.go` укажите следующие параметры:

```go
package tests

var Port = 7540
var DBFile = "../scheduler.db"
var FullNextDate = true
var Search = true
var Token = `СКОПИРОВАННЫЙ_ТОКЕН`
```

### Запуск тестов

Для запуска тестов выполните:

```sh
go test ./tests
```

## Cборка и запуск проекта через Docker

### Подготовка Dockerfile

В корневой папке проекта уже создан Dockerfile, если необходимо, в нем можно отредактировать переменные окружения.

### Сборка Docker образа

Выполните сборку Docker образа командой:

```sh
docker build -t todo-app .
```

### Запуск Docker контейнера

Запустите Docker контейнер командой:

```sh
docker run -d --name todo-app-container -p 7540:7540 todo-app
```

Приложение будет доступно по адресу http://localhost:7540